function getLocalFav(){function e(e){var n=[];o[e]=1;for(var a in o)n.push(a);localStorage.setItem("metalFav",n.join(","))}function n(e){var n=[];delete o[e];for(var a in o)n.push(a);localStorage.setItem("metalFav",n.join(","))}function a(e){return o[e]}var t,o={};return!function(){t=localStorage.getItem("metalFav"),t=t?t.split(","):[];for(var e=0,n=t.length;n>e;e++)o[t[e]]=1}(),{check:a,add:e,del:n}}function getCloudFav(e,n,a){function t(){h.option=h.api.add_fav_goods(token,e,n,{callback:function(t){t.success&&(a.innerHTML="<i></i>取消自选",a.className="btn fav unfav",i[e+"."+n]=1)}}),h.request(h.option)}function o(){h.option=h.api.del_fav_goods(token,e,n,{callback:function(t){t.success&&(a.innerHTML="<i></i>加入自选",a.className="btn fav",delete i[e+"."+n])}}),h.request(h.option)}function c(){return i[e+"."+n]}var i={},e=e,a=a,n=n;return!function(){h.option=h.api.query_fav_goods(token,{callback:function(e){for(var n=0,t=e.data.length;t>n;n++)i[e.data[n].exchange+"."+e.data[n].prodCode]=1;c()?(a.innerHTML="<i></i>取消自选",a.className="btn fav unfav"):(a.innerHTML="<i></i>加入自选",a.className="btn fav")}}),h.request(h.option)}(),{check:c,add:t,del:o}}function fireGoodBtns(e,n,a){var t,o=document.querySelector(e),c=o.querySelector("span"),i=o.querySelector("a"),r=a.split(".");i.href="market.html?tab="+n,isLogin?(t=getCloudFav(r.pop(),r.join("."),c),Event.add(c,"click",function(){t.check()?t.del():t.add()})):(t=getLocalFav(),t.check(a)?(c.innerHTML="<i></i>取消自选",c.className="btn fav unfav"):(c.innerHTML="<i></i>加入自选",c.className="btn fav"),Event.add(c,"click",function(){t.check(a)?(c.innerHTML="<i></i>加入自选",c.className="btn fav",t.del(a)):(c.innerHTML="<i></i>取消自选",c.className="btn fav unfav",t.add(a))}))}function switchbtn(e,n,a){function t(e){var a=Event.target(e);a!=i&&a.nodeName.toLowerCase()==n.toLowerCase()&&(i.className="btn",i=a,i.className="on btn")}var o=document.querySelector(e),c=o.querySelectorAll(n),i=c[(a||1)-1];i.className="btn on",Event.add(o,"click",function(e){t(e)})}